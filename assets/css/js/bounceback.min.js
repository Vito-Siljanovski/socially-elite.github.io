!function(t,e){"function"==typeof define&&define.amd?define(function(){return e(t,document,{})}):"undefined"!=typeof exports?global&&global.testEnv?e(global.testEnv,global.testEnv.document,exports):e(t,document,exports):t.Bounceback=e(t,document,{})}(window,function(s,a,i){function n(t,e,o){t.attachEvent?t.attachEvent("on"+e,o):t.addEventListener(e,o,!1)}var t=s.Bounceback,e=(i.noConflict=function(){return s.Bounceback=t,this},i.version="1.0.0",i.options={distance:100,maxDisplay:1,method:"auto",sensitivity:10,cookieLife:365,scrollDelay:500,aggressive:!1,checkReferrer:!0,storeName:"bounceback-visited",onBounce:function(){return i}},i.data={get:function(t){if(s.localStorage)return s.localStorage.getItem(t)||"";for(var e=a.cookie.split(";"),o=-1,i=[],n=e.length;++o<n;)if((i=e[o].split("="))[0]==t)return i.shift(),i.join("=");return""},set:function(t,e){var o;return s.localStorage?s.localStorage.setItem(t,e):((o=new Date).setDate(o.getDate()+i.options.cookieLife),a.cookie=t+"="+e+"; expires="+o.toUTCString()+";path=/;"),this}},0);return i.onBounce=function(){e++,(!this.options.maxDisplay||e<=this.options.maxDisplay)&&this.options.onBounce()},i.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(s.navigator.userAgent),i.disabled=!1,i.activated=!1,i.disable=function(){return this.disabled=!0,this},i.enable=function(){return this.disabled=!1,this},i.activate=function(t){var e,o;"history"==t?"replaceState"in s.history?(s.history.replaceState({isBouncing:!0},s.title),s.history.pushState(null,s.title),n(s,"popstate",function(){s.history.state&&s.history.state.isBouncing&&i.onBounce()})):"onhashchange"in s&&(s.location.replace("#bht"),s.location.hash="",n(s,"hashchange",function(){"bht"===s.location.hash.substr(-3)&&i.onBounce()})):(e=null,o=[],n(a,"mousemove",function(t){o.unshift({x:t.clientX,y:t.clientY}),o=o.slice(0,10)}),n(a,"mouseout",function(t){var e;i.disabled||(!(e=t.relatedTarget||t.toElement)||"HTML"==e.nodeName)&&t.clientY<=i.options.distance&&10==o.length&&o[0].y<o[9].y&&o[9].y-o[0].y>i.options.sensitivity&&i.onBounce()}),this.options.scrollDelay&&n(s,"scroll",function(){i.disabled||(i.disabled=!0,clearTimeout(e),e=setTimeout(function(){i.disabled=!1},i.options.scrollDelay))}))},i.init=function(t){var e,o;for(e in t=t||{},this.options)this.options.hasOwnProperty(e)&&!t.hasOwnProperty(e)&&(t[e]=this.options[e]);return(this.options=t).checkReferrer&&a.referrer&&((o=a.createElement("a")).href=a.referrer,o.host==s.location.host)&&this.data.set(t.storeName,"1"),this.activated||!t.aggressive&&this.data.get(t.storeName)||(this.activated=!0,this.activate("history"===t.method||"auto"===t.method&&this.isMobile?"history":"mouse"),this.data.set(t.storeName,"1")),this},i});